# 文章生成优化：观点表达与风格控制

**日期**: 2026-01-24  
**功能**: 文章生成优化  
**问题**: AI生成文章时引用网友观点、风格滑动条效果不明显  

## 一、问题背景

用户发现AI生成的文章存在以下问题：

### 问题1：过度引用网友观点
例如文章中出现：
> "有网友提到一个很形象的比喻：伊朗就像三国时期的袁绍..."

**问题分析**：
- AI应该模拟一个真人创作者，直接输出自己的观点
- 不应该总是借用"网友说"、"有人认为"这种转述式表达
- 这种表达方式让文章显得缺乏主见，不像真人写作

### 问题2：风格滑动条左右滑动差别不大
用户调整文章风格设置的6个滑动条时，发现左滑右滑生成的文章差别不明显。

**问题分析**：
查看代码 `src/utils/prompts.ts` 第754-760行的风格控制函数：

```typescript
const getStyleDescription = (value: number, leftDesc: string, rightDesc: string): string => {
  if (value < 20) return `非常${leftDesc}`;
  if (value < 40) return `比较${leftDesc}`;
  if (value < 60) return ''; // 中立，不添加描述 ⬅️ 范围太大！
  if (value < 80) return `比较${rightDesc}`;
  return `非常${rightDesc}`;
};
```

**问题所在**：
- 40-60这个范围（占20%）都被归为"中立"，不添加任何风格描述
- 用户滑动条从40滑到60时，没有任何效果
- 只有4个档位：非常左、比较左、比较右、非常右，中间档位缺失

## 二、解决方案

### 2.1 禁止引用式表达，强制直接观点输出

在通用提示词中添加新的 `4.1 观点表达原则（CRITICAL）`：

```markdown
### 4.1 观点表达原则（CRITICAL）
- ❌ **严禁使用**"有网友提到/认为/说"、"网友爆料"、"知情人士透露"、"据某某说"等引用式表达
- ❌ **严禁使用**"有人觉得"、"大家都说"、"很多人认为"等转述式表达
- ✅ **必须直接输出观点**：把所有观点都当作你自己的思考和判断来表达
- ✅ 例如：不要说"有网友提到一个形象的比喻"，直接说"我觉得这就像..."或"这让我想到..."
- ✅ 例如：不要说"有人认为伊朗像袁绍"，直接说"伊朗的情况就像三国时期的袁绍"
- ✅ 你要模拟一个真人创作者，所有分析、比喻、判断都是你自己想出来的，不要借用别人的口
```

**特殊规则**：
仅允许引用评论区的具体评论内容，格式为：
- ✅ "评论区有人说：'这波操作太绝了'"
- ✅ "看到一条评论说：'...'"
- ❌ 不允许"有网友提到一个观点/看法/分析"

### 2.2 优化风格控制阈值，增加档位

修改 `getStyleDescription` 函数，从4档增加到7档：

```typescript
const getStyleDescription = (value: number, leftDesc: string, rightDesc: string): string => {
  if (value < 15) return `非常${leftDesc}`;      // 0-14: 非常左
  if (value < 35) return `比较${leftDesc}`;      // 15-34: 比较左
  if (value < 45) return `略微${leftDesc}`;      // 35-44: 略微左 ⬅️ 新增
  if (value <= 55) return '';                    // 45-55: 中立（缩小到10%）
  if (value < 65) return `略微${rightDesc}`;     // 56-64: 略微右 ⬅️ 新增
  if (value < 85) return `比较${rightDesc}`;     // 65-84: 比较右
  return `非常${rightDesc}`;                     // 85-100: 非常右
};
```

**改进效果**：

| 滑动条值 | 旧方案 | 新方案 | 改进 |
|----------|--------|--------|------|
| 0-14 | 非常左 | 非常左 | - |
| 15-34 | 比较左 | 比较左 | - |
| 35-39 | 比较左 | **略微左** | ✅ 新增档位 |
| 40-44 | **中立（无效果）** | **略微左** | ✅ 有效果了 |
| 45-55 | **中立（无效果）** | 中立 | ✅ 范围缩小 |
| 56-59 | **中立（无效果）** | **略微右** | ✅ 有效果了 |
| 60-64 | **比较右** | **略微右** | ✅ 新增档位 |
| 65-84 | 比较右 | 比较右 | - |
| 85-100 | 非常右 | 非常右 | - |

**关键改进**：
1. 中立区间从20%（40-60）缩小到10%（45-55）
2. 新增"略微"档位，让过渡更平滑
3. 从4档增加到7档，滑动条变化更明显

## 三、实际效果对比

### 3.1 观点表达对比

**旧版本（引用式）**：
> 有网友提到一个很形象的比喻：伊朗就像三国时期的袁绍，起点很高，资源丰富，但治理能力和执行力存在明显短板。

**新版本（直接观点）**：
> 伊朗的情况让我想到三国时期的袁绍——起点很高，资源丰富，但治理能力和执行力存在明显短板。

或者：
> 从某种程度上说，伊朗就像三国时期的袁绍，家底厚实但执行力不行。

### 3.2 风格控制对比

以"立场倾向"（客观中立 ↔ 观点鲜明）为例：

**滑动条值 = 40**
- 旧版本：无任何风格描述（中立）
- 新版本：添加描述"略微客观中立，适当保持距离感"

**滑动条值 = 60**
- 旧版本：无任何风格描述（中立）
- 新版本：添加描述"略微观点鲜明，适当表达个人立场"

**滑动条值 = 70**
- 旧版本：添加描述"比较观点鲜明，大胆表达个人立场和看法"
- 新版本：添加描述"比较观点鲜明，大胆表达个人立场和看法"

可以看到，新版本在40-60这个区间也有明显的风格变化了！

## 四、技术实现

### 修改文件
- `src/utils/prompts.ts`

### 修改内容

1. **第450-480行**：重写观点表达规则
   - 新增 `4.1 观点表达原则（CRITICAL）`
   - 禁止引用式表达
   - 强制直接观点输出
   - 仅允许引用具体评论内容

2. **第755-763行**：优化风格控制阈值
   - 中立区间从 `< 60` 缩小到 `<= 55`
   - 新增"略微"档位：35-44, 56-64
   - 从4档增加到7档

3. **第837-839行**：更新版本号
   - 从 1.1.0 升级到 1.2.0

## 五、六个风格维度说明

这6个滑动条控制文章的不同方面：

| 维度 | 左极值（0） | 右极值（100） | 影响 |
|------|-------------|---------------|------|
| **立场倾向** | 客观中立 | 观点鲜明 | 是否明确表达立场 |
| **情感色彩** | 消极悲观 | 积极乐观 | 看待事物的角度 |
| **评价态度** | 批评质疑 | 赞美认可 | 对事件的评价倾向 |
| **表达方式** | 犀利直接 | 委婉礼貌 | 说话的尖锐程度 |
| **语言风格** | 口语随意 | 正式书面 | 文字的正式程度 |
| **趣味程度** | 严肃认真 | 幽默搞笑 | 内容的娱乐性 |

优化后，每个滑动条都有7个档位：

```
0 ──15──35──45──55──65──85── 100
  非常  比较  略微 中立 略微  比较  非常
```

## 六、用户反馈的修改建议

用户提供的文章示例中的问题：
> "有网友提到一个很形象的比喻：伊朗就像三国时期的袁绍..."

**修改建议**：
- ❌ 不要说"有网友提到"
- ✅ 直接说"我觉得伊朗就像袁绍"
- ✅ 或者"伊朗让我想到袁绍"
- ✅ 或者"从某种角度看，伊朗和袁绍挺像"

**核心原则**：
- AI要模拟一个真人创作者
- 所有观点都是"我"自己想出来的
- 不要借用别人的口来说话
- 哪怕原文是网友说的，也要当作自己的观点来表达

## 七、验证结果

```bash
npm run build
✓ 5479 modules transformed.
✓ built in 8.15s
Exit code: 0
```

构建成功！

## 八、注意事项

### 对通用提示词的影响
这次修改只影响通用提示词 `ARTICLE_PROMPT_TEMPLATE`，不影响三个平台的专属提示词。

### 平台专属规则优先级
根据之前建立的优先级机制，如果平台专属提示词中有关于观点表达的不同规则，会优先遵循平台专属规则。

### 设置迁移
版本号从1.1.0升级到1.2.0后，已有用户的自定义提示词会收到刷新提醒，可以选择更新到新版本。

## 九、后续优化建议

1. **A/B测试**：对比旧版本（引用式）和新版本（直接观点）生成的文章，看哪种更受欢迎
2. **用户反馈**：收集用户对风格控制改进的反馈，看7档是否过多或过少
3. **平台差异**：考虑不同平台对"观点鲜明度"的接受程度是否不同，可能需要平台专属的默认值

## 十、总结

通过这次优化：
1. ✅ 解决了AI过度引用网友观点的问题
2. ✅ 让文章更像真人写作，有主见、有态度
3. ✅ 风格滑动条从4档增加到7档，控制更精细
4. ✅ 中立区间从20%缩小到10%，滑动条变化更明显
5. ✅ 提升了文章的可读性和真实感
